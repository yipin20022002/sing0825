<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script></head><body><script>const delay=(seconds)=>{return new Promise((resolve)=>{setTimeout(resolve,seconds*1000);});};const main=async()=>{
var _E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80, _E8_A9_A6_E7_AE_97_E8_A1_A8ID, c, _E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E, arr, i;

function spreadsheetsql_QueryResponse_class(res) {
  spreadsheetsql_QueryResponse(res, "class");
}
window.spreadsheetsql_QueryResponse_class = spreadsheetsql_QueryResponse_class;

// 描述此函式...
function _E4_B8_8B_E6_8B_89_E9_81_B8_E5_96_AE__E9_A1_9E_E5_88_A5_E5_BB_BA_E7_AB_8B() {
  span_create('class',0,10,30,'查詢類別',999);
  select_create('class',200,50,140,10,'#ffffff','#000000',30,1,[],'',999,true);
  async function gameselect_class_onchange (event) {
    spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'名單');
    spreadsheetsql_executeSql((['select A,C,D,E,\'➕\' where B=\'',select_get('class',"selectedValue"),'\''].join('')), "query");
  };
  document.getElementById("gameselect_class").addEventListener("change", gameselect_class_onchange, true);
  spreadsheetsql_getDataFinish_class = function() {
    var arr = [['', '']];
    var i_end = (spreadsheetsql_getDataCount("ROWS"));
    var i_inc = 1;
    if (1 > i_end) {
      i_inc = -i_inc;
    }
    for (i = 1; i_inc >= 0 ? i <= i_end : i >= i_end; i += i_inc) {
      if ((spreadsheetsql_getCell(1, i)) != null) {
        arr.push([spreadsheetsql_getCell(1, i), spreadsheetsql_getCell(1, i)]);
      }
    }
    select_set('class',"option",arr);

  };
  spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'選單');
  spreadsheetsql_executeSql('select A', "class");
}

function spreadsheetsql_QueryResponse_query(res) {
  spreadsheetsql_QueryResponse(res, "query");
}
window.spreadsheetsql_QueryResponse_query = spreadsheetsql_QueryResponse_query;

// 描述此函式...
function _E9_97_9C_E9_8D_B5_E5_AD_97_E6_9F_A5_E8_A9_A2_E5_BB_BA_E7_AB_8B() {
  span_create('keyword',0,70,30,'關鍵字',999);
  text_create('keyword',200,50,140,70,'#ffffff','#000000',30,1,'',999,true);
  button_create('keyword',100,50,360,70,1,null,'查詢',30,999,true);
  async function gamebutton_keyword_onclick (event) {
    spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'名單');
    spreadsheetsql_executeSql((['select A,C,D,E,\'➕\' where C like \'%',text_get('keyword',"value"),'%\' or D like \'%',text_get('keyword',"value"),'%\' or E like \'%',text_get('keyword',"value"),'%\''].join('')), "query");
  };
  document.getElementById("gamebutton_keyword").addEventListener("click", gamebutton_keyword_onclick, true);
  spreadsheetsql_getDataFinish_query = function() {
    spreadsheetsql_getDataTable('',600,20,0,150,false);
    select_set('class',"value",'');
    select_set('unit',"value",'');

  };
}

function spreadsheetsql_QueryResponse_unit(res) {
  spreadsheetsql_QueryResponse(res, "unit");
}
window.spreadsheetsql_QueryResponse_unit = spreadsheetsql_QueryResponse_unit;

// 描述此函式...
function _E4_B8_8B_E6_8B_89_E9_81_B8_E5_96_AE__E5_96_AE_E4_BD_8D_E5_BB_BA_E7_AB_8B() {
  span_create('unit',360,10,30,'查詢單位',999);
  select_create('unit',200,50,500,10,'#ffffff','#000000',30,1,[],'',999,true);
  async function gameselect_unit_onchange (event) {
    spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'名單');
    spreadsheetsql_executeSql((['select A,C,D,E,\'➕\' where C=\'',select_get('unit',"selectedValue"),'\''].join('')), "query");
  };
  document.getElementById("gameselect_unit").addEventListener("change", gameselect_unit_onchange, true);
  spreadsheetsql_getDataFinish_unit = function() {
    var arr = [['', '']];
    var i_end2 = (spreadsheetsql_getDataCount("ROWS"));
    var i_inc2 = 1;
    if (1 > i_end2) {
      i_inc2 = -i_inc2;
    }
    for (i = 1; i_inc2 >= 0 ? i <= i_end2 : i >= i_end2; i += i_inc2) {
      if ((spreadsheetsql_getCell(1, i)) != null) {
        arr.push([spreadsheetsql_getCell(1, i), spreadsheetsql_getCell(1, i)]);
      }
    }
    select_set('unit',"option",arr);

  };
  spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'選單');
  spreadsheetsql_executeSql('select B', "unit");
}

function spreadsheetsql_QueryResponse_add(res) {
  spreadsheetsql_QueryResponse(res, "add");
}
window.spreadsheetsql_QueryResponse_add = spreadsheetsql_QueryResponse_add;

// 描述此函式...
function _E8_A1_A8_E6_A0_BC_E9_BB_9E_E9_81_B8_E5_81_B5_E6_B8_AC_E5_BB_BA_E7_AB_8B() {
  setInterval(async function(){
    var c = (table_get('',"onclick[Column,Row]"));
    if (c[0] == 4) {
      _E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E = [table_td_get('',1,(c[1]),"innerHTML"), table_td_get('',2,(c[1]),"innerHTML"), table_td_get('',3,(c[1]),"innerHTML")];
      spreadsheetsql_settings(_E8_A9_A6_E7_AE_97_E8_A1_A8ID,'簽到');
      spreadsheetsql_executeSql((['select * where A=\'',table_td_get('',1,(c[1]),"innerHTML"),'\' and B=\'',table_td_get('',2,(c[1]),"innerHTML"),'\' and C=\'',table_td_get('',3,(c[1]),"innerHTML"),'\''].join('')), "add");
    }
  },10);
  spreadsheetsql_getDataFinish_add = function() {
    if ((spreadsheetsql_getDataCount("ROWS")) == 0) {
      var windowConfirm = window.confirm((['你確定要新增 [ ',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));
      if (windowConfirm==true) {
          spreadsheet_insert("insertrow2", String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[0])+"|"+String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[1])+"|"+String(_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2])+"|"+String("gmt_datetime"), 0, 0, "", _E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80, '簽到', "https://script.google.com/macros/s/AKfycbxA3hhTlntwVTOcqngOC_iJL_zLmRwzcDbMYDs7FD8iinNsY9XZsMkD7AcXTIUbEc33EA/exec");
        alert((['已新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));

      }
      else {
          alert((['已取消新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));

      }
    } else {
      alert((['已存在無法新增  [',_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E[2],' ]'].join('')));
    }

  };
}


// 簽到表網址要是共用編輯網址
_E7_B0_BD_E5_88_B0_E8_A1_A8_E7_B6_B2_E5_9D_80 = 'https://docs.google.com/spreadsheets/d/19CBtzQYJDyX0edf4S5mZFvLIkbrJZroSEIf2cOY2T4A/edit?usp=sharing';
_E8_A9_A6_E7_AE_97_E8_A1_A8ID = '19CBtzQYJDyX0edf4S5mZFvLIkbrJZroSEIf2cOY2T4A';
_E8_B3_87_E6_96_99_E6_96_B0_E5_A2_9E = [];
_E4_B8_8B_E6_8B_89_E9_81_B8_E5_96_AE__E9_A1_9E_E5_88_A5_E5_BB_BA_E7_AB_8B();
_E4_B8_8B_E6_8B_89_E9_81_B8_E5_96_AE__E5_96_AE_E4_BD_8D_E5_BB_BA_E7_AB_8B();
_E8_A1_A8_E6_A0_BC_E9_BB_9E_E9_81_B8_E5_81_B5_E6_B8_AC_E5_BB_BA_E7_AB_8B();
_E9_97_9C_E9_8D_B5_E5_AD_97_E6_9F_A5_E8_A9_A2_E5_BB_BA_E7_AB_8B();
// 網址要是簽到當頁的顯示網址
iframe_create('',700,700,800,10,"0","yes",'https://docs.google.com/spreadsheets/d/19CBtzQYJDyX0edf4S5mZFvLIkbrJZroSEIf2cOY2T4A/edit#gid=1078943391','',1,999,true);
};main();</script></body></html>